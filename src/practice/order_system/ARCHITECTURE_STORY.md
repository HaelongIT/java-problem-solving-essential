# � [가상 시나리오] 대용량 주문 로그 정산 시스템

이 코드는 **대형 이커머스 회사 "메가몰(MegaMall)"의 정산 팀**에서 사용하는 **레거시 로그 처리 모듈**의 일부입니다.

---

## 📅 배경 상황 (Context)

당신은 메가몰 정산팀의 **백엔드 엔지니어**입니다.
현재 메가몰의 주문 데이터는 대부분 DB에 잘 쌓이고 있지만, **일부 제휴 업체(Vendor)**나 **오래된 POS 시스템**에서는 아직도 **텍스트 형태의 Raw 로그**로 주문 내역을 보내오고 있습니다.

이 텍스트 로그는 형식이 매우 지저분하고, **결제 금액이 계산되지 않은 상태**로 들어옵니다.
당신의 임무는 이 지저분한 로그를 실시간으로 읽어들여, **정확한 실제 매출액을 계산하고 유효성을 검증**하여 정산 DB에 적재하는 것입니다.

---

## ⚙️ 시스템 구성 (System Architecture)

이 모듈은 전체 정산 파이프라인의 **'전처리 및 계산 엔진(Preprocessing & Calculation Engine)'** 역할을 수행합니다.

### 1. 외부 유입 (Client: PracticeRunner)
- 제휴사 서버(또는 배치 스케줄러)가 주기적으로 텍스트 로그를 우리 API 서버로 전송합니다.
- **예시 로그**: `"ORD001|user1|PROD001:2,PROD002:1|SALE10"` (주문ID | 유저ID | 상품목록 | 쿠폰코드)

### 2. 요청 핸들러 (Controller: OrderController)
- **역할**: 외부 시스템과의 통신을 담당하는 API 진입점.
- **임무**: 들어온 로그가 빈 값은 아닌지 1차 확인하고, 처리가 끝나면 "처리 완료(200)" 혹은 "데이터 오류(400)" 응답을 제휴사 서버에 돌려줍니다.

### 3. 데이터 파서 (Parser: OrderParser)
- **역할**: 레거시 데이터 변환기.
- **임무**: `|` (파이프), `:` (콜론), `,` (쉼표)로 뒤엉킨 비정형 텍스트를 우리 시스템이 이해할 수 있는 **표준 주문 객체(ParsedOrder)**로 변환합니다. 정규식이든 문자열 처리든 가장 빠르고 정확하게 데이터를 발라내야 합니다.

### 4. 핵심 로직 엔진 (Service: OrderService)
- **역할**: 정산 금액 계산기.
- **임무**: 파싱된 데이터를 바탕으로 **실제 결제되어야 할 금액**을 확정합니다.
    - � **가장 중요한 비즈니스 규칙**:
        - "비활성 또는 탈퇴한 회원의 주문은 아닌가?"
        - "골드 등급 회원은 20% 할인이 정확히 적용되었는가?"
        - "시스템에 등록되지 않은 상품(존재하지 않는 ID)이 포함되진 않았는가?"
    - 이 로직이 틀리면 회사의 매출 데이터가 꼬이거나, 고객에게 잘못된 금액이 청구되는 **금전적 사고**가 발생합니다.

### 5. 데이터 참조 (Mapper: OrderMapper)
- **역할**: 마스터 데이터 조회 (Master Data Management).
- **임무**: 계산에 필요한 '회원 등급 정보'와 '현재 상품 단가'를 **고속 조회**합니다. 실무에서는 DB를 사용하지만, 이 연습 모듈에서는 **HashMap을 사용하여 DB 조회를 시뮬레이션**합니다. (실전에서 캐시 레이어를 구현하는 연습)

---

## 🎯 당신의 미션

지금 이 시스템은 껍데기(Controller)만 만들어져 있고, 핵심 부품들이 비어있어 **정산 처리가 중단된 상태**입니다.

1.  **Parser 복구**: 제휴사에서 보낸 로그가 깨지지 않게 완벽하게 해석해내야 합니다.
2.  **Mapper 연결**: 상품 단가와 고객 정보를 정확하게 매핑해 와야 합니다.
3.  **Service 구현**: 할인 정책을 정확히 코드로 구현하여, **단 1원의 오차도 없는 최종 금액**을 산출해내십시오.
